(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26691,e=>{"use strict";var a=e.i(66027),t=e.i(54616),s=e.i(12598),i=e.i(7471),r=e.i(57951);function l(){let{user:e}=(0,r.useAuth)(),l=(0,s.useQueryClient)(),d=(0,a.useQuery)({queryKey:["favorites",e?.id],queryFn:async()=>{if(!e)return[];let{data:a,error:t}=await i.supabase.from("favorites").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(t)throw t;return a},enabled:!!e}),n=(0,t.useMutation)({mutationFn:async a=>{if(!e)throw Error("Must be logged in");let{error:t}=await i.supabase.from("favorites").insert({user_id:e.id,...a});if(t)throw t},onSuccess:()=>{l.invalidateQueries({queryKey:["favorites",e?.id]})}}),o=(0,t.useMutation)({mutationFn:async a=>{if(!e)throw Error("Must be logged in");let{error:t}=await i.supabase.from("favorites").delete().eq("user_id",e.id).eq("drama_id",a.drama_id).eq("platform",a.platform);if(t)throw t},onSuccess:()=>{l.invalidateQueries({queryKey:["favorites",e?.id]})}}),c=(e,a)=>d.data?.some(t=>t.drama_id===e&&t.platform===a)??!1,m=async e=>{c(e.drama_id,e.platform)?await o.mutateAsync({drama_id:e.drama_id,platform:e.platform}):await n.mutateAsync(e)};return{favorites:d.data??[],isLoading:d.isLoading,isFavorite:c,toggleFavorite:m,addFavorite:n.mutate,removeFavorite:o.mutate,isToggling:n.isPending||o.isPending}}e.s(["useFavorites",()=>l])},77390,e=>{"use strict";var a=e.i(43476),t=e.i(2971),s=e.i(84276),i=e.i(90597),r=e.i(31343),l=e.i(37727),d=e.i(59684),n=e.i(26691),o=e.i(57951),c=e.i(75157),m=e.i(57688),u=e.i(22016),f=e.i(46696);function x({limit:e,className:t}){let{user:s}=(0,o.useAuth)(),{favorites:x,isLoading:h,removeFavorite:p}=(0,n.useFavorites)(),v=e?x.slice(0,e):x;return s?h?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("span",{className:"text-muted-foreground",children:"Memuat..."})}):0===x.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[(0,a.jsx)(i.Heart,{className:"w-12 h-12 mb-3 opacity-50"}),(0,a.jsx)("p",{className:"text-center",children:"Belum ada drama favorit"}),(0,a.jsx)("p",{className:"text-sm text-center mt-1",children:"Tambahkan drama ke favorit dengan menekan ikon hati"})]}):(0,a.jsxs)("div",{className:(0,c.cn)("space-y-4",t),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.Heart,{className:"w-5 h-5 fill-red-500 text-red-500"}),(0,a.jsxs)("h3",{className:"font-semibold",children:["Drama Favorit (",x.length,")"]})]}),(0,a.jsx)(d.ScrollArea,{className:"max-h-[400px]",children:(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:v.map(e=>(0,a.jsxs)("div",{className:"relative group rounded-lg overflow-hidden",children:[(0,a.jsx)(u.default,{href:`/drama/${e.platform}/${e.drama_id}`,children:(0,a.jsxs)("div",{className:"aspect-[2/3] relative",children:[e.drama_cover?(0,a.jsx)(m.default,{src:e.drama_cover,alt:e.drama_title,fill:!0,className:"object-cover"}):(0,a.jsx)("div",{className:"w-full h-full bg-muted flex items-center justify-center",children:(0,a.jsx)(r.Play,{className:"w-8 h-8 text-muted-foreground"})}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-2",children:[(0,a.jsx)("p",{className:"text-white text-sm font-medium line-clamp-2",children:e.drama_title}),e.drama_genre&&(0,a.jsx)("p",{className:"text-white/70 text-xs line-clamp-1",children:e.drama_genre})]}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(r.Play,{className:"w-10 h-10 text-white"})})]})}),(0,a.jsx)("button",{onClick:()=>{p({drama_id:e.drama_id,platform:e.platform},{onSuccess:()=>f.toast.success("Dihapus dari favorit"),onError:()=>f.toast.error("Gagal menghapus")})},className:"absolute top-2 right-2 p-1.5 rounded-full bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity text-white hover:bg-red-500",children:(0,a.jsx)(l.X,{className:"w-4 h-4"})})]},`${e.drama_id}-${e.platform}`))})})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[(0,a.jsx)(i.Heart,{className:"w-12 h-12 mb-3 opacity-50"}),(0,a.jsx)("p",{className:"text-center",children:"Login untuk melihat favorit"})]})}function h(){return(0,a.jsxs)("main",{className:"min-h-screen pb-20",children:[(0,a.jsx)(t.Header,{}),(0,a.jsxs)("div",{className:"container mx-auto px-4 pt-20",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Drama Favorit"}),(0,a.jsx)(x,{})]}),(0,a.jsx)(s.BottomNav,{})]})}e.s(["default",()=>h],77390)}]);