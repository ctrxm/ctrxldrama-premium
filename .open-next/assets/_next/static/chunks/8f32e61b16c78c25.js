(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73375,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},63059,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},70956,e=>{"use strict";let t=(0,e.i(75254).default)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);e.s(["List",()=>t],70956)},30964,e=>{"use strict";var t=e.i(43476),s=e.i(71645),i=e.i(18566),r=e.i(68030),l=e.i(73375),a=e.i(63059),n=e.i(31278),c=e.i(70956),d=e.i(63209),o=e.i(22016),h=e.i(75157);function m(){let e=(0,i.useParams)(),m=(0,i.useRouter)(),x=e.bookId,u=e.videoId,[f,p]=(0,s.useState)(u),[w,b]=(0,s.useState)(!1),[v,j]=(0,s.useState)(0),[y,g]=(0,s.useState)(!1),[k,N]=(0,s.useState)(!1),C=(0,s.useRef)(null),R=(0,s.useRef)(Date.now()),z=(0,s.useRef)(!0),{data:I,isLoading:U,error:$,refetch:M}=(0,r.useFlickReelsDetail)(x);(0,s.useEffect)(()=>{e.videoId&&e.videoId!==f&&(p(e.videoId),j(0),g(!1),N(!1))},[e.videoId]);let L=(0,s.useMemo)(()=>I?.episodes||[],[I]),E=(0,s.useMemo)(()=>L.findIndex(e=>e.id===f),[L,f]),S=(0,s.useMemo)(()=>-1===E?null:L[E],[L,E]),D=L.length;(0,s.useEffect)(()=>{if(!S?.raw?.videoUrl)return;R.current=Date.now();let e=S.raw.videoUrl,t=`/api/proxy/video?url=${encodeURIComponent(e)}&referer=${encodeURIComponent("https://www.flickreels.com/")}&_t=${R.current}`,s=`/api/proxy/warmup?url=${encodeURIComponent(e)}`;z.current?(g(!1),N(!1),fetch(s).then(e=>e.json()).then(e=>{console.log("[Warmup] Initial load:",e.success?"success":"failed"),g(!0),e.success||N(!0),z.current=!1}).catch(e=>{console.error("[Warmup] Error:",e),g(!0),N(!0),z.current=!1})):C.current&&(C.current.src=t,C.current.load(),C.current.play().catch(()=>{}),fetch(s).catch(()=>{}))},[S?.raw?.videoUrl,v]),(0,s.useEffect)(()=>{if(!y||!S?.raw?.videoUrl||!C.current)return;let e=`/api/proxy/video?url=${encodeURIComponent(S.raw.videoUrl)}&referer=${encodeURIComponent("https://www.flickreels.com/")}&_t=${R.current}`;C.current.src!==e&&!C.current.src.endsWith(e.split("?")[1])&&(C.current.src=e,C.current.load(),C.current.play().catch(()=>{}),z.current&&(z.current=!1))},[y,S?.raw?.videoUrl]);let P=(e,t=!1)=>{p(e),j(0),b(!1),t?window.history.replaceState(null,"",`/watch/flickreels/${x}/${e}`):m.push(`/watch/flickreels/${x}/${e}`)};if(U)return(0,t.jsxs)("div",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center space-y-4",children:[(0,t.jsx)(n.Loader2,{className:"w-12 h-12 animate-spin text-primary"}),(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("h3",{className:"text-white font-medium text-lg",children:"Memuat video..."}),(0,t.jsx)("p",{className:"text-white/60 text-sm",children:"Mohon tunggu sebentar, data sedang diambil."})]})]});if($||!I)return(0,t.jsxs)("div",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center p-4",children:[(0,t.jsx)(d.AlertCircle,{className:"w-12 h-12 text-destructive mb-4"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Drama tidak ditemukan"}),(0,t.jsx)(o.default,{href:"/",className:"text-primary hover:underline",children:"Kembali ke beranda"})]});let{drama:A}=I;return(0,t.jsxs)("div",{className:"fixed inset-0 bg-black flex flex-col",children:[(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 z-40 h-16 pointer-events-none",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/90 via-black/50 to-transparent"}),(0,t.jsxs)("div",{className:"relative z-10 flex items-center justify-between h-full px-4 max-w-7xl mx-auto pointer-events-auto",children:[(0,t.jsxs)(o.default,{href:`/detail/flickreels/${x}`,className:"flex items-center gap-2 text-white/90 hover:text-white transition-colors p-2 -ml-2 rounded-full hover:bg-white/10",children:[(0,t.jsx)(l.ChevronLeft,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-primary font-bold hidden sm:inline shadow-black drop-shadow-md",children:"SekaiDrama"})]}),(0,t.jsxs)("div",{className:"text-center flex-1 px-4 min-w-0",children:[(0,t.jsx)("h1",{className:"text-white font-medium truncate text-sm sm:text-base drop-shadow-md",children:A.title}),(0,t.jsx)("p",{className:"text-white/80 text-xs drop-shadow-md",children:S?`Episode ${S.index+1}`:"Episode ?"})]}),(0,t.jsx)("button",{onClick:()=>b(!w),className:"p-2 text-white/90 hover:text-white transition-colors rounded-full hover:bg-white/10",children:(0,t.jsx)(c.List,{className:"w-6 h-6 drop-shadow-md"})})]})]}),(0,t.jsxs)("div",{className:"flex-1 w-full h-full relative bg-black flex flex-col items-center justify-center",children:[(0,t.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[(0,t.jsx)("video",{ref:C,controls:!0,autoPlay:!0,className:(0,h.cn)("w-full h-full object-contain max-h-[100dvh]",(!S||!y)&&"invisible"),poster:S?.raw?.chapter_cover,onEnded:()=>{let e=E+1;e<D&&P(L[e].id,!0)},onError:async e=>{v<2&&(console.log("Video load failed, refetching fresh data..."),j(e=>e+1),await M())},referrerPolicy:"no-referrer"}),(!S||!y)&&(0,t.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center z-20 flex-col gap-2",children:[(0,t.jsx)(n.Loader2,{className:"w-10 h-10 text-primary animate-spin"}),!y&&S&&(0,t.jsx)("span",{className:"text-white/60 text-sm",children:"Preparing video..."})]})]}),(0,t.jsx)("div",{className:"absolute bottom-20 md:bottom-12 left-0 right-0 z-40 pointer-events-none flex justify-center pb-safe-area-bottom",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 md:gap-6 pointer-events-auto bg-black/60 backdrop-blur-md px-3 py-1.5 md:px-6 md:py-3 rounded-full border border-white/10 shadow-lg transition-all scale-90 md:scale-100 origin-bottom",children:[(0,t.jsx)("button",{onClick:()=>{let e=L[E-1];e&&P(e.id)},disabled:E<=0,className:"p-1.5 md:p-2 rounded-full text-white disabled:opacity-30 hover:bg-white/10 transition-colors",children:(0,t.jsx)(l.ChevronLeft,{className:"w-4 h-4 md:w-6 md:h-6"})}),(0,t.jsxs)("span",{className:"text-white font-medium text-xs md:text-sm tabular-nums min-w-[60px] md:min-w-[80px] text-center",children:["Ep ",S?S.index+1:1," / ",D]}),(0,t.jsx)("button",{onClick:()=>{let e=L[E+1];e&&P(e.id)},disabled:E>=D-1,className:"p-1.5 md:p-2 rounded-full text-white disabled:opacity-30 hover:bg-white/10 transition-colors",children:(0,t.jsx)(a.ChevronRight,{className:"w-4 h-4 md:w-6 md:h-6"})})]})})]}),w&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60]",onClick:()=>b(!1)}),(0,t.jsxs)("div",{className:"fixed inset-y-0 right-0 w-72 bg-zinc-900 z-[70] overflow-y-auto border-l border-white/10 shadow-2xl animate-in slide-in-from-right",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-white/10 sticky top-0 bg-zinc-900 z-10 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h2",{className:"font-bold text-white",children:"Daftar Episode"}),(0,t.jsxs)("span",{className:"text-xs text-white/60 bg-white/10 px-2 py-0.5 rounded-full",children:["Total ",D]})]}),(0,t.jsx)("button",{onClick:()=>b(!1),className:"p-1 text-white/70 hover:text-white",children:(0,t.jsx)(a.ChevronRight,{className:"w-6 h-6"})})]}),(0,t.jsx)("div",{className:"p-3 grid grid-cols-5 gap-2",children:L.map(e=>(0,t.jsx)("button",{onClick:()=>P(e.id),className:(0,h.cn)("aspect-square flex items-center justify-center rounded-lg text-sm font-medium transition-all",e.id===f?"bg-primary text-white shadow-lg shadow-primary/20":"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white"),children:e.index+1},e.id))})]})]})]})}e.s(["default",()=>m])}]);