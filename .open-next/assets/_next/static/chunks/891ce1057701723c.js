(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73375,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},63059,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},42929,e=>{"use strict";var t=e.i(43476),a=e.i(63209);let r=(0,e.i(75254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function i({message:e="Terjadi kesalahan saat memuat data.",title:i="Gagal Memuat",onRetry:s,retryLabel:o="Coba Lagi"}){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 md:p-12 text-center space-y-6 bg-[#1a1625] rounded-2xl border border-white/5 mx-auto max-w-4xl w-full",children:[(0,t.jsx)("div",{className:"rounded-full bg-red-500/10 p-4 ring-1 ring-red-500/20",children:(0,t.jsx)(a.AlertCircle,{className:"w-8 h-8 text-red-500"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"font-display font-bold text-lg md:text-xl text-white",children:i}),(0,t.jsx)("p",{className:"text-sm text-white/60 max-w-sm mx-auto",children:e})]}),s&&(0,t.jsxs)("button",{onClick:s,className:"flex items-center gap-2 px-6 py-2.5 rounded-full bg-[#3D2942] text-purple-300 text-sm font-medium hover:bg-[#4D3453] transition-colors hover:text-purple-200",children:[(0,t.jsx)(r,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:o})]})]})}e.s(["UnifiedErrorDisplay",()=>i],42929)},57306,e=>{"use strict";var t=e.i(43476),a=e.i(90597),r=e.i(19455),i=e.i(26691),s=e.i(57951),o=e.i(75157),l=e.i(46696);function n({drama_id:e,platform:n,drama_title:u,drama_cover:d,drama_genre:c,variant:m="icon",className:f}){let{user:h}=(0,s.useAuth)(),{isFavorite:p,toggleFavorite:v,isToggling:y}=(0,i.useFavorites)(),w=p(e,n),g=async t=>{if(t.preventDefault(),t.stopPropagation(),!h)return void l.toast.error("Silakan login terlebih dahulu");try{await v({drama_id:e,platform:n,drama_title:u,drama_cover:d,drama_genre:c}),l.toast.success(w?"Dihapus dari favorit":"Ditambahkan ke favorit")}catch{l.toast.error("Gagal memperbarui favorit")}};return"icon"===m?(0,t.jsx)("button",{onClick:g,disabled:y,className:(0,o.cn)("p-2 rounded-full bg-black/50 hover:bg-black/70 transition-colors",f),children:(0,t.jsx)(a.Heart,{className:(0,o.cn)("w-5 h-5 transition-colors",w?"fill-red-500 text-red-500":"text-white")})}):(0,t.jsxs)(r.Button,{onClick:g,disabled:y,variant:w?"default":"outline",className:f,children:[(0,t.jsx)(a.Heart,{className:(0,o.cn)("w-4 h-4 mr-2",w&&"fill-current")}),w?"Hapus dari Favorit":"Tambah ke Favorit"]})}e.s(["FavoriteButton",()=>n])},70273,e=>{"use strict";let t=(0,e.i(75254).default)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],70273)},26691,e=>{"use strict";var t=e.i(66027),a=e.i(54616),r=e.i(12598),i=e.i(7471),s=e.i(57951);function o(){let{user:e}=(0,s.useAuth)(),o=(0,r.useQueryClient)(),l=(0,t.useQuery)({queryKey:["favorites",e?.id],queryFn:async()=>{if(!e)return[];let{data:t,error:a}=await i.supabase.from("favorites").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(a)throw a;return t},enabled:!!e}),n=(0,a.useMutation)({mutationFn:async t=>{if(!e)throw Error("Must be logged in");let{error:a}=await i.supabase.from("favorites").insert({user_id:e.id,...t});if(a)throw a},onSuccess:()=>{o.invalidateQueries({queryKey:["favorites",e?.id]})}}),u=(0,a.useMutation)({mutationFn:async t=>{if(!e)throw Error("Must be logged in");let{error:a}=await i.supabase.from("favorites").delete().eq("user_id",e.id).eq("drama_id",t.drama_id).eq("platform",t.platform);if(a)throw a},onSuccess:()=>{o.invalidateQueries({queryKey:["favorites",e?.id]})}}),d=(e,t)=>l.data?.some(a=>a.drama_id===e&&a.platform===t)??!1,c=async e=>{d(e.drama_id,e.platform)?await u.mutateAsync({drama_id:e.drama_id,platform:e.platform}):await n.mutateAsync(e)};return{favorites:l.data??[],isLoading:l.isLoading,isFavorite:d,toggleFavorite:c,addFavorite:n.mutate,removeFavorite:u.mutate,isToggling:n.isPending||u.isPending}}e.s(["useFavorites",()=>o])},64659,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],3116)},68148,46695,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(74080);var r=e.i(91918),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,i)=>{let s=(0,r.createSlot)(`Primitive.${i}`),o=a.forwardRef((e,a)=>{let{asChild:r,...o}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(r?s:i,{...o,ref:a})});return o.displayName=`Primitive.${i}`,{...e,[i]:o}},{}),s="Progress",[o,l]=function(e,r=[]){let i=[],s=()=>{let t=i.map(e=>a.createContext(e));return function(r){let i=r?.[e]||t;return a.useMemo(()=>({[`__scope${e}`]:{...r,[e]:i}}),[r,i])}};return s.scopeName=e,[function(r,s){let o=a.createContext(s);o.displayName=r+"Context";let l=i.length;i=[...i,s];let n=r=>{let{scope:i,children:s,...n}=r,u=i?.[e]?.[l]||o,d=a.useMemo(()=>n,Object.values(n));return(0,t.jsx)(u.Provider,{value:d,children:s})};return n.displayName=r+"Provider",[n,function(t,i){let n=i?.[e]?.[l]||o,u=a.useContext(n);if(u)return u;if(void 0!==s)return s;throw Error(`\`${t}\` must be used within \`${r}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let i=r.reduce((t,{useScope:a,scopeName:r})=>{let i=a(e)[`__scope${r}`];return{...t,...i}},{});return a.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}(s,...r)]}(s),[n,u]=o(s),d=a.forwardRef((e,a)=>{var r,s;let{__scopeProgress:o,value:l=null,max:u,getValueLabel:d=f,...c}=e;(u||0===u)&&!v(u)&&console.error((r=`${u}`,`Invalid prop \`max\` of value \`${r}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let m=v(u)?u:100;null===l||y(l,m)||console.error((s=`${l}`,`Invalid prop \`value\` of value \`${s}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let w=y(l,m)?l:null,g=p(w)?d(w,m):void 0;return(0,t.jsx)(n,{scope:o,value:w,max:m,children:(0,t.jsx)(i.div,{"aria-valuemax":m,"aria-valuemin":0,"aria-valuenow":p(w)?w:void 0,"aria-valuetext":g,role:"progressbar","data-state":h(w,m),"data-value":w??void 0,"data-max":m,...c,ref:a})})});d.displayName=s;var c="ProgressIndicator",m=a.forwardRef((e,a)=>{let{__scopeProgress:r,...s}=e,o=u(c,r);return(0,t.jsx)(i.div,{"data-state":h(o.value,o.max),"data-value":o.value??void 0,"data-max":o.max,...s,ref:a})});function f(e,t){return`${Math.round(e/t*100)}%`}function h(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function p(e){return"number"==typeof e}function v(e){return p(e)&&!isNaN(e)&&e>0}function y(e,t){return p(e)&&!isNaN(e)&&e<=t&&e>=0}m.displayName=c;var w=e.i(75157);let g=a.forwardRef(({className:e,value:a,...r},i)=>(0,t.jsx)(d,{ref:i,className:(0,w.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:(0,t.jsx)(m,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));g.displayName=d.displayName,e.s(["Progress",()=>g],68148);var x=e.i(66027),_=e.i(54616),b=e.i(12598),N=e.i(7471),k=e.i(57951);function C(){let{user:e}=(0,k.useAuth)(),t=(0,b.useQueryClient)(),a=(0,x.useQuery)({queryKey:["watch_history",e?.id],queryFn:async()=>{if(!e)return[];let{data:t,error:a}=await N.supabase.from("watch_history").select("*").eq("user_id",e.id).order("last_watched_at",{ascending:!1}).limit(50);if(a)throw a;return t},enabled:!!e}),r=(0,_.useMutation)({mutationFn:async t=>{if(!e)throw Error("Must be logged in");let{error:a}=await N.supabase.from("watch_history").upsert({user_id:e.id,drama_id:t.drama_id,platform:t.platform,drama_title:t.drama_title,drama_cover:t.drama_cover,episode_id:t.episode_id,episode_number:t.episode_number??1,watch_position:t.watch_position??0,duration:t.duration??0,last_watched_at:new Date().toISOString()},{onConflict:"user_id,drama_id,platform,episode_id"});if(a)throw a},onSuccess:()=>{t.invalidateQueries({queryKey:["watch_history",e?.id]})}}),i=(0,_.useMutation)({mutationFn:async()=>{if(!e)throw Error("Must be logged in");let{error:t}=await N.supabase.from("watch_history").delete().eq("user_id",e.id);if(t)throw t},onSuccess:()=>{t.invalidateQueries({queryKey:["watch_history",e?.id]})}}),s=(0,_.useMutation)({mutationFn:async t=>{if(!e)throw Error("Must be logged in");let{error:a}=await N.supabase.from("watch_history").delete().eq("user_id",e.id).eq("drama_id",t.drama_id).eq("platform",t.platform);if(a)throw a},onSuccess:()=>{t.invalidateQueries({queryKey:["watch_history",e?.id]})}});return{history:a.data??[],isLoading:a.isLoading,updateHistory:r.mutate,clearHistory:i.mutate,removeFromHistory:s.mutate,getResumePosition:(e,t,r)=>{let i=a.data?.find(a=>a.drama_id===e&&a.platform===t&&(!r||a.episode_id===r));return i?{position:i.watch_position,episode:i.episode_number}:null},getRecentlyWatched:(e=10)=>{let t=new Map;return a.data?.forEach(e=>{let a=`${e.drama_id}-${e.platform}`;(!t.has(a)||new Date(e.last_watched_at)>new Date(t.get(a).last_watched_at))&&t.set(a,e)}),Array.from(t.values()).slice(0,e)}}}e.s(["useWatchHistory",()=>C],46695)}]);