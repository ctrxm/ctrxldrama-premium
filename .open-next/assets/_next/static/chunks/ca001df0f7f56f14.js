(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73375,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},63059,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},70956,e=>{"use strict";let t=(0,e.i(75254).default)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);e.s(["List",()=>t],70956)},46835,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(18566),s=e.i(4671),i=e.i(73375),r=e.i(63059),n=e.i(31278),d=e.i(70956),o=e.i(63209),c=e.i(22016),h=e.i(75157),m=e.i(50471);function u(){let e=(0,l.useParams)(),u=(0,l.useSearchParams)(),x=(0,l.useRouter)(),f=e.bookId,[p,g]=(0,a.useState)(0),[b,v]=(0,a.useState)(!1),[y,w]=(0,a.useState)("h264"),[j,k]=(0,a.useState)(!0),N=(0,a.useRef)(null),L=(0,a.useRef)(null),{data:E,isLoading:C,error:R}=(0,s.useFreeReelsDetail)(f);(0,a.useEffect)(()=>{let e=u.get("ep");if(e){let t=parseInt(e,10)-1;!isNaN(t)&&t>=0&&g(t)}},[u]);let M=E?.data,A=(0,a.useMemo)(()=>M?.episodes||[],[M]),S=A.length,z=(0,a.useMemo)(()=>A[p]||A[0]||null,[A,p]),I=(0,a.useMemo)(()=>{if(!z)return"";let e="";return e="h265"===y&&z.external_audio_h265_m3u8?z.external_audio_h265_m3u8:z.external_audio_h264_m3u8||z.videoUrl||"",z.subtitleUrl&&z.originalAudioLanguage,e},[z,y]),D=(0,a.useMemo)(()=>z?.subtitleUrl?`/api/proxy/video?url=${encodeURIComponent(z.subtitleUrl)}`:"",[z]);(0,a.useEffect)(()=>{if(!I)return;let e=j?`/api/proxy/video?url=${encodeURIComponent(I)}`:I,t=N.current;if(t){if(L.current&&(L.current.destroy(),L.current=null),m.default.isSupported()&&(e.includes(".m3u8")||j)){console.log(`Loading video: ${j?"Proxy":"Direct"} from ${e}`);let a=new m.default({enableWorker:!0,lowLatencyMode:!1,maxBufferLength:10,maxMaxBufferLength:20,backBufferLength:10,xhrSetup:function(e){e.withCredentials=!1},manifestLoadingRetryDelay:2e3,manifestLoadingMaxRetry:3,fragLoadingRetryDelay:2e3,fragLoadingMaxRetry:3,levelLoadingMaxRetry:3});L.current=a,a.loadSource(e),a.attachMedia(t),a.on(m.default.Events.MANIFEST_PARSED,()=>{t.play().catch(()=>console.log("Autoplay prevented"))}),a.on(m.default.Events.ERROR,(e,t)=>{t.fatal&&(console.log("HLS Fatal Error:",t.type),a.destroy(),j||(console.log("Direct play failed, switching to proxy..."),k(!0)))})}else t.canPlayType("application/vnd.apple.mpegurl")?(t.src=e,t.play().catch(()=>{})):(t.src=e,t.play().catch(()=>{}));return()=>{L.current&&L.current.destroy()}}},[I,j]),(0,a.useEffect)(()=>{let e=N.current;if(!e)return;let t=()=>{if(!D||z?.originalAudioLanguage==="id-ID")return;let t=Array.from(e.getElementsByTagName("track")).find(e=>"Indonesia"===e.label&&"id"===e.srclang);if(t)if(t.src===D)return;else e.removeChild(t);let a=document.createElement("track");a.kind="subtitles",a.label="Indonesia",a.srclang="id",a.default=!0,a.src=D,a.onload=()=>{a.track&&(a.track.mode="showing")},e.appendChild(a)},a=()=>{let t=Array.from(e.textTracks).find(e=>"Indonesia"===e.label||"id"===e.language);t&&"showing"!==t.mode&&(t.mode="showing")};t(),e.addEventListener("loadeddata",a),e.addEventListener("canplay",a),e.addEventListener("playing",a),e.addEventListener("seeked",a),L.current&&(L.current.on(m.default.Events.MANIFEST_PARSED,()=>{t(),a()}),L.current.on(m.default.Events.LEVEL_SWITCHED,()=>{t(),a()}));let l=0,s=setInterval(()=>{t(),a(),++l>10&&clearInterval(s)},200);return()=>{e.removeEventListener("loadeddata",a),e.removeEventListener("canplay",a),e.removeEventListener("playing",a),e.removeEventListener("seeked",a),clearInterval(s);try{let t=Array.from(e.getElementsByTagName("track")).find(e=>e.src===D);t&&e.removeChild(t)}catch(e){}}},[D,I,y,z?.originalAudioLanguage]);let P=e=>{e===p||(v(!1),console.log("Current Ep Data:",z),console.log("Proxied Subtitle URL:",D),console.log("Original Audio:",z?.originalAudioLanguage),x.push(`/watch/freereels/${f}?ep=${e+1}`))};return C?(0,t.jsxs)("div",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center space-y-4",children:[(0,t.jsx)(n.Loader2,{className:"w-12 h-12 animate-spin text-primary"}),(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("h3",{className:"text-white font-medium text-lg",children:"Memuat video..."}),(0,t.jsx)("p",{className:"text-white/60 text-sm",children:"Mohon tunggu sebentar..."})]})]}):R||!M?(0,t.jsxs)("div",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center p-4",children:[(0,t.jsx)(o.AlertCircle,{className:"w-12 h-12 text-destructive mb-4"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Video tidak ditemukan"}),(0,t.jsx)(c.default,{href:"/",className:"text-primary hover:underline",children:"Kembali ke beranda"})]}):(0,t.jsxs)("div",{className:"fixed inset-0 bg-black flex flex-col",children:[(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 z-40 h-16 pointer-events-none",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black/90 via-black/50 to-transparent"}),(0,t.jsxs)("div",{className:"relative z-10 flex items-center justify-between h-full px-4 max-w-7xl mx-auto pointer-events-auto",children:[(0,t.jsxs)(c.default,{href:`/detail/freereels/${f}`,className:"flex items-center gap-2 text-white/90 hover:text-white transition-colors p-2 -ml-2 rounded-full hover:bg-white/10",children:[(0,t.jsx)(i.ChevronLeft,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-primary font-bold hidden sm:inline shadow-black drop-shadow-md",children:"SekaiDrama"})]}),(0,t.jsxs)("div",{className:"text-center flex-1 px-4 min-w-0",children:[(0,t.jsx)("h1",{className:"text-white font-medium truncate text-sm sm:text-base drop-shadow-md",children:M.title}),(0,t.jsx)("p",{className:"text-white/80 text-xs drop-shadow-md",children:z?`Episode ${(z.index||p)+1}`:"Episode ?"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex bg-black/40 backdrop-blur-sm rounded-lg p-1 border border-white/10",children:[(0,t.jsx)("button",{onClick:()=>w("h264"),className:(0,h.cn)("text-[10px] px-2 py-1 rounded-md transition-all font-medium","h264"===y?"bg-primary text-white":"text-white/70 hover:text-white"),children:"H.264"}),(0,t.jsx)("button",{onClick:()=>w("h265"),className:(0,h.cn)("text-[10px] px-2 py-1 rounded-md transition-all font-medium","h265"===y?"bg-primary text-white":"text-white/70 hover:text-white"),children:"H.265"})]}),(0,t.jsx)("button",{onClick:()=>v(!b),className:"p-2 text-white/90 hover:text-white transition-colors rounded-full hover:bg-white/10",children:(0,t.jsx)(d.List,{className:"w-6 h-6 drop-shadow-md"})})]})]})]}),(0,t.jsxs)("div",{className:"flex-1 w-full h-full relative bg-black flex flex-col items-center justify-center",children:[(0,t.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:I?(0,t.jsx)("video",{ref:N,controls:!0,autoPlay:!0,className:"w-full h-full object-contain max-h-[100dvh]",poster:M.cover,onEnded:()=>{let e=p+1;e<S&&x.replace(`/watch/freereels/${f}?ep=${e+1}`)},...{disableRemotePlayback:!0,referrerPolicy:"no-referrer"},crossOrigin:"anonymous"}):(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-20 flex-col gap-4",children:(0,t.jsx)("p",{className:"text-white/60",children:"URL Video tidak ditemukan"})})}),(0,t.jsx)("div",{className:"absolute bottom-20 md:bottom-12 left-0 right-0 z-40 pointer-events-none flex justify-center pb-safe-area-bottom",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 md:gap-6 pointer-events-auto bg-black/60 backdrop-blur-md px-3 py-1.5 md:px-6 md:py-3 rounded-full border border-white/10 shadow-lg transition-all scale-90 md:scale-100 origin-bottom",children:[(0,t.jsx)("button",{onClick:()=>P(p-1),disabled:p<=0,className:"p-1.5 md:p-2 rounded-full text-white disabled:opacity-30 hover:bg-white/10 transition-colors",children:(0,t.jsx)(i.ChevronLeft,{className:"w-4 h-4 md:w-6 md:h-6"})}),(0,t.jsxs)("span",{className:"text-white font-medium text-xs md:text-sm tabular-nums min-w-[60px] md:min-w-[80px] text-center",children:["Ep ",z?(z.index||p)+1:1," / ",S]}),(0,t.jsx)("button",{onClick:()=>P(p+1),disabled:p>=S-1,className:"p-1.5 md:p-2 rounded-full text-white disabled:opacity-30 hover:bg-white/10 transition-colors",children:(0,t.jsx)(r.ChevronRight,{className:"w-4 h-4 md:w-6 md:h-6"})})]})})]}),b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60]",onClick:()=>v(!1)}),(0,t.jsxs)("div",{className:"fixed inset-y-0 right-0 w-72 bg-zinc-900 z-[70] overflow-y-auto border-l border-white/10 shadow-2xl animate-in slide-in-from-right",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-white/10 sticky top-0 bg-zinc-900 z-10 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h2",{className:"font-bold text-white",children:"Daftar Episode"}),(0,t.jsxs)("span",{className:"text-xs text-white/60 bg-white/10 px-2 py-0.5 rounded-full",children:["Total ",S]})]}),(0,t.jsx)("button",{onClick:()=>v(!1),className:"p-1 text-white/70 hover:text-white",children:(0,t.jsx)(r.ChevronRight,{className:"w-6 h-6"})})]}),(0,t.jsx)("div",{className:"p-3 grid grid-cols-5 gap-2",children:A.map((e,a)=>(0,t.jsx)("button",{onClick:()=>P(a),className:(0,h.cn)("aspect-square flex items-center justify-center rounded-lg text-sm font-medium transition-all",a===p?"bg-primary text-white shadow-lg shadow-primary/20":"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white"),children:(e.index||a)+1},e.id))})]})]})]})}e.s(["default",()=>u])}]);