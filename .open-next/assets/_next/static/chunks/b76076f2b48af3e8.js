(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63059,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},70956,e=>{"use strict";let t=(0,e.i(75254).default)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);e.s(["List",()=>t],70956)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},20879,e=>{"use strict";var t=e.i(66027),s=e.i(73652);let a="/api/dramabox";async function l(e){return(0,s.fetchJson)(`${a}/detail/${e}`)}async function r(e){return(0,s.fetchJson)(`${a}/allepisode/${e}`)}function i(e){return(0,t.useQuery)({queryKey:["drama","detail",e],queryFn:()=>l(e),enabled:!!e,staleTime:3e5})}function n(e){return(0,t.useQuery)({queryKey:["drama","episodes",e],queryFn:()=>r(e),enabled:!!e,staleTime:3e5})}e.s(["useDramaDetail",()=>i,"useEpisodes",()=>n])},39616,e=>{"use strict";let t=(0,e.i(75254).default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Settings",()=>t],39616)},95242,e=>{"use strict";let t=(0,e.i(75254).default)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);e.s(["Pause",()=>t],95242)},2384,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),l=e.i(20879),r=e.i(75254);let i=(0,r.default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),n=(0,r.default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var o=e.i(64659),c=e.i(31278),d=e.i(39616),u=e.i(70956),m=e.i(63209),h=e.i(31343),x=e.i(95242);let p=(0,r.default)("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),f=(0,r.default)("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);var b=e.i(22016),g=e.i(55146);function y(){let e=(0,a.useParams)().bookId,r=(0,a.useSearchParams)(),y=(0,a.useRouter)(),[w,j]=(0,s.useState)(0),[v,k]=(0,s.useState)(720),[N,C]=(0,s.useState)(!1),[M,P]=(0,s.useState)(!0),[L,z]=(0,s.useState)(!1),[S,q]=(0,s.useState)(!1),[D,T]=(0,s.useState)({current:0,duration:0}),I=(0,s.useRef)(null),A=(0,s.useRef)(null),$=(0,s.useRef)(null),{data:R,isLoading:E}=(0,l.useDramaDetail)(e||""),{data:B,isLoading:H}=(0,l.useEpisodes)(e||"");(0,s.useEffect)(()=>{let e=parseInt(r.get("ep")||"0",10);e>=0&&j(e)},[r]);let K=(0,s.useCallback)(()=>{A.current&&clearTimeout(A.current),P(!0),A.current=setTimeout(()=>{P(!1)},3e3)},[]),U=t=>{j(t),C(!1),y.push(`/watch/dramabox/${e}?ep=${t}`)},V=(0,s.useCallback)(()=>{w>0&&U(w-1)},[w]),F=(0,s.useCallback)(()=>{B&&w<B.length-1&&U(w+1)},[w,B]),Q=(0,s.useMemo)(()=>B&&B[w]||null,[B,w]),J=(0,s.useMemo)(()=>Q&&(Q.cdnList.find(e=>1===e.isDefault)||Q.cdnList[0])||null,[Q]),O=(0,s.useMemo)(()=>{let e=J?.videoPathList?.map(e=>e.quality).filter(e=>"number"==typeof e);return Array.from(new Set(e&&e.length?e:[720])).sort((e,t)=>t-e)},[J]);(0,s.useEffect)(()=>{O.length&&(O.includes(v)||k(O[0]))},[O,v]);let X=(0,s.useCallback)(()=>{if(I.current){let e=I.current.currentTime;Math.floor(e)!==Math.floor(D.current)&&T({current:e,duration:I.current.duration})}},[D.current]),W=(0,s.useCallback)(()=>{I.current&&T({current:0,duration:I.current.duration})},[]),G=(0,s.useCallback)(()=>{I.current&&(L?I.current.pause():I.current.play(),z(!L))},[L]),Y=(0,s.useCallback)(()=>{I.current&&(I.current.muted=!S,q(!S))},[S]),Z=(0,s.useCallback)(e=>{I.current&&(I.current.currentTime=e,T({current:e,duration:I.current.duration}))},[]),_=(0,s.useCallback)(e=>{let t=Math.floor(e/60),s=Math.floor(e%60);return`${t}:${s.toString().padStart(2,"0")}`},[]),ee=null;null!==R&&"object"==typeof R&&"bookId"in R&&"coverWap"in R?ee={bookId:R.bookId,bookName:R.bookName,introduction:R.introduction}:null!==R&&"object"==typeof R&&"data"in R&&R.data?.book!==void 0&&(ee={bookId:R.data.book.bookId,bookName:R.data.book.bookName,introduction:R.data.book.introduction});let et=B?.length||0;if(E||H)return(0,t.jsxs)("main",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-20 h-20 border-4 border-primary/20 border-t-primary rounded-full animate-spin"}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)(h.Play,{className:"w-8 h-8 text-primary animate-pulse"})})]}),(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("h3",{className:"text-white font-semibold text-lg",children:"Loading video..."}),(0,t.jsx)("p",{className:"text-white/60 text-sm",children:"Please wait a moment"})]})]});if(!ee||!B)return(0,t.jsxs)("main",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"w-24 h-24 rounded-full glass-strong flex items-center justify-center mb-6",children:(0,t.jsx)(m.AlertCircle,{className:"w-12 h-12 text-destructive"})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Drama not found"}),(0,t.jsx)("p",{className:"text-white/60 mb-6",children:"The content you're looking for is unavailable"}),(0,t.jsx)(b.default,{href:"/",className:"btn-premium",children:"Back to Home"})]});let es=(()=>{if(!Q||!J)return"";let e=J.videoPathList.find(e=>e.quality===v)||J.videoPathList.find(e=>1===e.isDefault)||J.videoPathList[0];return e?.videoPath||""})();return(0,t.jsxs)("main",{ref:$,className:"fixed inset-0 bg-black overflow-hidden",onMouseMove:K,onTouchStart:K,children:[(0,t.jsxs)("div",{className:"w-full h-full relative",children:[es?(0,t.jsx)("video",{ref:I,src:es,className:"w-full h-full object-cover",playsInline:!0,autoPlay:!0,preload:"auto",poster:Q?.chapterImg,onTimeUpdate:X,onLoadedMetadata:W,onEnded:()=>{F()},onPlay:()=>z(!0),onPause:()=>z(!1),onClick:G,onContextMenu:e=>e.preventDefault(),disablePictureInPicture:!0}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(c.Loader2,{className:"w-12 h-12 text-primary animate-spin"})}),M&&(0,t.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 p-4 sm:p-6 flex items-center justify-between bg-gradient-to-b from-black/80 to-transparent safe-top pointer-events-auto",children:[(0,t.jsx)("button",{onClick:()=>y.back(),className:"p-2 sm:p-3 rounded-xl glass-strong hover:bg-white/20 transition-all duration-300",children:(0,t.jsx)(i,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),(0,t.jsxs)("div",{className:"flex-1 text-center px-4",children:[(0,t.jsx)("h1",{className:"text-white font-semibold text-sm sm:text-base line-clamp-1",children:ee.bookName}),(0,t.jsxs)("p",{className:"text-white/70 text-xs sm:text-sm",children:["Episode ",w+1," / ",et]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(g.DropdownMenu,{children:[(0,t.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)("button",{className:"p-2 sm:p-3 rounded-xl glass-strong hover:bg-white/20 transition-all duration-300",children:(0,t.jsx)(d.Settings,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})})}),(0,t.jsxs)(g.DropdownMenuContent,{align:"end",className:"glass-strong border-border/50",children:[(0,t.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-muted-foreground",children:"Quality"}),O.map(e=>(0,t.jsxs)(g.DropdownMenuItem,{onClick:()=>k(e),className:v===e?"text-primary font-semibold":"",children:[e,"p ",v===e&&"âœ“"]},e))]})]}),(0,t.jsx)("button",{onClick:()=>C(!0),className:"p-2 sm:p-3 rounded-xl glass-strong hover:bg-white/20 transition-all duration-300",children:(0,t.jsx)(u.List,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})})]})]}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsx)("button",{onClick:G,className:"pointer-events-auto p-6 sm:p-8 rounded-full glass-strong hover:scale-110 transition-all duration-300",children:L?(0,t.jsx)(x.Pause,{className:"w-10 h-10 sm:w-12 sm:h-12 text-white fill-white"}):(0,t.jsx)(h.Play,{className:"w-10 h-10 sm:w-12 sm:h-12 text-white fill-white ml-1"})})}),(0,t.jsxs)("div",{className:"absolute right-4 sm:right-6 top-1/2 -translate-y-1/2 flex flex-col gap-3 sm:gap-4 pointer-events-auto",children:[w>0&&(0,t.jsx)("button",{onClick:V,className:"p-3 sm:p-4 rounded-full glass-strong hover:bg-white/20 transition-all duration-300",children:(0,t.jsx)(n,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),w<et-1&&(0,t.jsx)("button",{onClick:F,className:"p-3 sm:p-4 rounded-full glass-strong hover:bg-white/20 transition-all duration-300",children:(0,t.jsx)(o.ChevronDown,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})})]}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 sm:p-6 bg-gradient-to-t from-black/80 to-transparent safe-bottom pointer-events-auto",children:(0,t.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h2",{className:"text-white font-semibold text-sm sm:text-base",children:Q?.chapterName||`Episode ${w+1}`}),ee.introduction&&(0,t.jsx)("p",{className:"text-white/80 text-xs sm:text-sm line-clamp-2",children:ee.introduction})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-white/80 text-xs sm:text-sm tabular-nums",children:_(D.current)}),(0,t.jsx)("div",{className:"flex-1 h-1 sm:h-1.5 bg-white/20 rounded-full cursor-pointer relative group",onClick:e=>{let t=e.currentTarget.getBoundingClientRect();Z((e.clientX-t.left)/t.width*D.duration)},children:(0,t.jsx)("div",{className:"h-full bg-primary rounded-full relative transition-all duration-150",style:{width:`${D.duration?D.current/D.duration*100:0}%`},children:(0,t.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-3 h-3 sm:w-4 sm:h-4 bg-white rounded-full shadow-lg"})})}),(0,t.jsx)("span",{className:"text-white/80 text-xs sm:text-sm tabular-nums",children:_(D.duration)}),(0,t.jsx)("button",{onClick:Y,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:S?(0,t.jsx)(f,{className:"w-5 h-5 text-white"}):(0,t.jsx)(p,{className:"w-5 h-5 text-white"})})]})]})})]})]}),N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50",onClick:()=>C(!1)}),(0,t.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 max-h-[70vh] glass-premium rounded-t-3xl z-50 overflow-hidden animate-in slide-in-from-bottom",children:[(0,t.jsxs)("div",{className:"p-4 sm:p-6 border-b border-border/50 flex items-center justify-between",children:[(0,t.jsxs)("h2",{className:"font-bold text-xl text-foreground",children:["Episodes (",et,")"]}),(0,t.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 rounded-lg glass-strong hover:bg-white/10 transition-colors text-sm font-medium",children:"Close"})]}),(0,t.jsx)("div",{className:"p-4 sm:p-6 overflow-y-auto max-h-[calc(70vh-80px)] custom-scrollbar",children:(0,t.jsx)("div",{className:"grid grid-cols-5 sm:grid-cols-8 md:grid-cols-10 gap-2 sm:gap-3",children:B.map((e,s)=>(0,t.jsx)("button",{onClick:()=>U(s),className:`
                      aspect-square rounded-xl font-semibold text-sm sm:text-base
                      transition-all duration-300
                      ${s===w?"bg-gradient-to-br from-primary to-accent text-white shadow-lg shadow-primary/30 scale-105":"glass-strong hover:bg-white/10 text-foreground"}
                    `,children:s+1},e.chapterId))})})]})]})]})}e.s(["default",()=>y],2384)}]);